# Mini Claude Code Agent

[English](README.md) | [ä¸­æ–‡](README_zh.md)

Claude Code CLI ç¼–ç¨‹åŠ©æ‰‹çš„æœ€å°å®ç°ç‰ˆæœ¬ã€‚

## æ¦‚è¿°

Mini Claude Code Agent æ˜¯ Claude Code çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå®ƒå…è®¸ AI æ¨¡å‹é€šè¿‡ä¸€ç»„å¼ºå¤§çš„å·¥å…·ç›´æ¥ä¸æ‚¨çš„ä»£ç åº“è¿›è¡Œäº¤äº’ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œä½¿ Claude èƒ½å¤Ÿï¼š

- è¯»å–å’Œå†™å…¥æ–‡ä»¶
- æ‰§è¡Œ shell å‘½ä»¤
- ç¼–è¾‘æ–‡ä»¶ä¸­çš„æ–‡æœ¬
- å¯¼èˆªé¡¹ç›®ç»“æ„

æ­¤å·¥å…·æ—¨åœ¨ä¸ LLM æ¨¡å‹ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æä¾›äº¤äº’å¼ç¼–ç ä½“éªŒï¼ŒLLM å¯ä»¥ç›´æ¥å¯¹æ‚¨çš„ä»£ç åº“è¿›è¡Œæ›´æ”¹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **ç¼–ç¨‹åŠ©æ‰‹**ï¼šä½¿ç”¨å¤§å‹è¯­è¨€æ¨¡å‹ä½œä¸ºæ ¸å¿ƒ AI å¼•æ“
- **æ–‡ä»¶æ“ä½œ**ï¼šæ”¯æŒè¯»å–ã€å†™å…¥å’Œç¼–è¾‘æ–‡ä»¶
- **Shell æ‰§è¡Œ**ï¼šå¯ä»¥åœ¨é¡¹ç›®å·¥ä½œåŒºä¸­æ‰§è¡Œ shell å‘½ä»¤
- **MCP é›†æˆ**ï¼šæ”¯æŒ Model Context Protocolï¼Œå¯è¿æ¥å¤šç§ MCP æœåŠ¡å™¨æ‰©å±•åŠŸèƒ½
- **ä¸Šä¸‹æ–‡å‹ç¼©**ï¼šæ™ºèƒ½çš„è‡ªåŠ¨å’Œæ‰‹åŠ¨ä¸Šä¸‹æ–‡å‹ç¼©ï¼Œå¤„ç†é•¿å¯¹è¯çš„ token é™åˆ¶
- **å®æ—¶çŠ¶æ€æ **ï¼šæ˜¾ç¤º MCP è¿æ¥çŠ¶æ€å’Œä¸Šä¸‹æ–‡ä½¿ç”¨ç‡ï¼Œä¸€ç›®äº†ç„¶
- **å®‰å…¨é™åˆ¶**ï¼šé˜²æ­¢è·¯å¾„éå†å’Œå±é™©å‘½ä»¤æ‰§è¡Œ
- **å®æ—¶åé¦ˆ**ï¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æä¾›è§†è§‰åé¦ˆ
- **æ¨¡å—åŒ–æ¶æ„**ï¼šç»„ç»‡è‰¯å¥½çš„ä»£ç åº“ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•

## æŠ€æœ¯æ ˆ

- TypeScript
- Node.js
- Anthropic AI SDK
- MCP (Model Context Protocol) SDK

## å‰ææ¡ä»¶

- Node.js >= 16.0.0
- Anthropic å…¼å®¹çš„ API å¯†é’¥
- ä»£ç† LLM æ¨¡å‹

## å¿«é€Ÿå¯åŠ¨

æœ€å¿«çš„å¯åŠ¨æ–¹å¼ï¼š

1. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export ANTHROPIC_API_KEY="your-api-key-here"
export ANTHROPIC_BASE_URL="your-anthropic-compatible-api-base-url"
export ANTHROPIC_MODEL="model-name"
```

2. ä½¿ç”¨ npx ç›´æ¥è¿è¡Œï¼ˆæ— éœ€å®‰è£…ï¼‰ï¼š

```bash
npx -y @scipen/mini-claude-code
```

å°±æ˜¯è¿™ä¹ˆç®€å•ï¼åŠ©æ‰‹ä¼šå¯åŠ¨ï¼Œä½ å¯ä»¥å¼€å§‹ä¸å®ƒäº¤äº’ã€‚

## å®‰è£…

```bash
npm install -g @scipen/mini-claude-code
```

æˆ–è€…ä»æºç å…‹éš†å¹¶æ„å»ºï¼š

```bash
git clone https://github.com/scipenai/mini-claude-code.git
cd mini-claude-code
npm install
```

## é…ç½®

å°†æ‚¨çš„ Anthropic API å¯†é’¥è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ï¼š

```bash
export ANTHROPIC_API_KEY="your-api-key-here"
export ANTHROPIC_BASE_URL="your-anthropic-compatable-api-base-url"
export ANTHROPIC_MODEL="model-name"
```

## å®‰è£…ä¾èµ–

```bash
npm install
```

## æ„å»ºé¡¹ç›®

```bash
npm run build
```

## è¿è¡Œé¡¹ç›®

### å¼€å‘æ¨¡å¼è¿è¡Œ

```bash
npm run dev
```

### ç”Ÿäº§æ¨¡å¼è¿è¡Œ

```bash
npm run build
npm start
```

## ä½¿ç”¨æ–¹æ³•

å¯åŠ¨ç¨‹åºåï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯ä¸­ä¸ä»£ç åŠ©æ‰‹è¿›è¡Œäº¤äº’ï¼š

1. è¾“å…¥æ‚¨çš„éœ€æ±‚æˆ–é—®é¢˜
2. åŠ©æ‰‹å°†è‡ªåŠ¨åˆ†æå¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼ˆå¦‚æ–‡ä»¶ä¿®æ”¹ã€å‘½ä»¤æ‰§è¡Œç­‰ï¼‰
3. æŸ¥çœ‹æ‰§è¡Œç»“æœå’Œè¾“å‡º

è¾“å…¥ `exit` æˆ– `quit` é€€å‡ºç¨‹åºã€‚

### å¯ç”¨å‘½ä»¤

- `/help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
- `/clear` - æ¸…å±
- `/history` - æ˜¾ç¤ºå¯¹è¯å†å²
- `/reset` - é‡ç½®å¯¹è¯å†å²
- `/compact` - æ‰‹åŠ¨å‹ç¼©å¯¹è¯å†å²ä¸ºæ‘˜è¦
- `/stats` - æ˜¾ç¤ºä¸Šä¸‹æ–‡ä½¿ç”¨ç»Ÿè®¡
- `/save` - ä¿å­˜å½“å‰å¯¹è¯åˆ°æ–‡ä»¶
- `/load` - ä»æ–‡ä»¶åŠ è½½å¯¹è¯å†å²
- `/todo` - æ˜¾ç¤ºå¾…åŠäº‹é¡¹çŠ¶æ€
- `exit/quit` - é€€å‡ºç¨‹åº

### ä¸Šä¸‹æ–‡å‹ç¼©

Mini Claude Code æ”¯æŒæ™ºèƒ½çš„ä¸Šä¸‹æ–‡å‹ç¼©åŠŸèƒ½ï¼Œå¯ä»¥å¤„ç†é•¿å¯¹è¯çš„ token é™åˆ¶é—®é¢˜ï¼š

- **è‡ªåŠ¨å‹ç¼©**ï¼šå½“ token ä½¿ç”¨ç‡è¾¾åˆ° 92% æ—¶è‡ªåŠ¨è§¦å‘ï¼Œé€æ˜åœ°å‹ç¼©å¯¹è¯å†å²ä¸ºæ‘˜è¦
- **æ‰‹åŠ¨å‹ç¼©**ï¼šä½¿ç”¨ `/compact` å‘½ä»¤æ‰‹åŠ¨å‹ç¼©å¯¹è¯å†å²
- **ç»Ÿè®¡æŸ¥çœ‹**ï¼šä½¿ç”¨ `/stats` å‘½ä»¤æŸ¥çœ‹å½“å‰çš„ token ä½¿ç”¨æƒ…å†µ

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [ä¸Šä¸‹æ–‡å‹ç¼©æ–‡æ¡£](docs/CONTEXT_COMPRESSION_zh.md) ([English](docs/CONTEXT_COMPRESSION.md))ã€‚

### å®æ—¶çŠ¶æ€æ 

åœ¨æ¯æ¬¡å‘½ä»¤åæ˜¾ç¤ºå®æ—¶çŠ¶æ€ä¿¡æ¯ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”Œ MCP: 2 â”‚ ğŸŸ¢ Context: 45% â”‚ ğŸ’¬ Messages: 67                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **MCP çŠ¶æ€**ï¼šæ˜¾ç¤ºå·²è¿æ¥çš„ MCP æœåŠ¡å™¨æ•°é‡
- **ä¸Šä¸‹æ–‡ä½¿ç”¨ç‡**ï¼šç”¨é¢œè‰²ç¼–ç æ˜¾ç¤ºä¸Šä¸‹æ–‡ä½¿ç”¨ç™¾åˆ†æ¯”
  - ğŸŸ¢ ç»¿è‰² (0-74%): æ­£å¸¸
  - ğŸŸ¡ é»„è‰² (75-91%): è­¦å‘Š
  - ğŸ”´ çº¢è‰² (92-100%): ä¸´ç•Œï¼ˆå³å°†è‡ªåŠ¨å‹ç¼©ï¼‰
- **æ¶ˆæ¯æ•°é‡**ï¼šå½“å‰å¯¹è¯çš„æ¶ˆæ¯æ€»æ•°

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [çŠ¶æ€æ æ–‡æ¡£](docs/STATUS_BAR_zh.md) ([English](docs/STATUS_BAR.md))ã€‚

## MCP é›†æˆ

Mini Claude Code æ”¯æŒ Model Context Protocol (MCP)ï¼Œå¯ä»¥è¿æ¥å„ç§ MCP æœåŠ¡å™¨æ¥æ‰©å±•åŠŸèƒ½ã€‚

### é…ç½® MCP æœåŠ¡å™¨

1. åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.mcp.json` æ–‡ä»¶ï¼š

```bash
cp .mcp.example.json .mcp.json
```

2. ç¼–è¾‘é…ç½®æ–‡ä»¶æ·»åŠ ä½ éœ€è¦çš„ MCP æœåŠ¡å™¨ã€‚

æ”¯æŒä¸‰ç§ä¼ è¾“æ–¹å¼ï¼š
- **stdio**: æœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼ˆé»˜è®¤ï¼‰
- **streamable_http**: HTTP è¿œç¨‹æœåŠ¡å™¨ï¼ˆæ¨èï¼‰
- **sse**: æ—§ç‰ˆ HTTP/SSEï¼ˆå·²å¼ƒç”¨ï¼‰

```json
{
  "mcpServers": [
    {
      "name": "filesystem",
      "transport": "stdio",
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-filesystem", "/path/to/directory"]
    },
    {
      "name": "remote-service",
      "transport": "streamable_http",
      "url": "https://your-mcp-server.example.com/mcp"
    }
  ]
}
```

è¯¦ç»†çš„ MCP é…ç½®å’Œä½¿ç”¨è¯´æ˜ï¼Œè¯·å‚é˜…ï¼š
- [MCP é›†æˆæŒ‡å—](docs/MCP_GUIDE_zh.md)
- [MCP ä¼ è¾“æ–¹å¼è¯¦è§£](docs/MCP_TRANSPORT_zh.md)

### äº¤äº’ç¤ºä¾‹

```
User: åˆ›å»ºä¸€ä¸ªåä¸º hello.js çš„æ–°æ–‡ä»¶ï¼Œæ‰“å° "Hello, World!"
Assistant: æˆ‘å°†åˆ›å»ºä¸€ä¸ªåä¸º hello.js çš„æ–°æ–‡ä»¶ï¼Œæ‰“å° "Hello, World!"ã€‚

Tool: write_file
{
  "path": "hello.js",
  "content": "console.log('Hello, World!');\n"
}

Result: wrote 26 bytes to hello.js

æˆ‘å·²ç»åˆ›å»ºäº† hello.js æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œåœ¨æ§åˆ¶å°æ‰“å° "Hello, World!"ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ `node hello.js` è¿è¡Œå®ƒã€‚
```

## å®‰å…¨æ€§

è¯¥åŠ©æ‰‹åŒ…å«å‡ é¡¹å®‰å…¨æªæ–½ï¼š

- é˜»æ­¢å±é™©å‘½ä»¤å¦‚ `rm -rf /`ã€`shutdown`ã€`reboot` å’Œ `sudo`
- é™åˆ¶æ–‡ä»¶è®¿é—®åˆ°å½“å‰å·¥ä½œç›®å½•
- ä¸ºå‘½ä»¤æ‰§è¡Œå®ç°è¶…æ—¶æœºåˆ¶

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ config/                    # é…ç½®å’Œç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ environment.ts          # ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ mcp-config.ts           # MCP æœåŠ¡å™¨é…ç½®
â”œâ”€â”€ core/                      # æ ¸å¿ƒåŠ©æ‰‹é€»è¾‘
â”‚   â”œâ”€â”€ agent.ts                # ä¸»è¦åŠ©æ‰‹é€»è¾‘ï¼ˆå«è‡ªåŠ¨å‹ç¼©ï¼‰
â”‚   â”œâ”€â”€ mcp-client.ts           # MCP å®¢æˆ·ç«¯ç®¡ç†å™¨
â”‚   â”œâ”€â”€ todo-manager.ts         # Todo ä»»åŠ¡ç®¡ç†
â”‚   â””â”€â”€ todo-reminder.ts        # Todo æé†’åŠŸèƒ½
â”œâ”€â”€ tools/                     # å·¥å…·å®ç°
â”‚   â”œâ”€â”€ bash.ts                 # Shell å‘½ä»¤æ‰§è¡Œ
â”‚   â”œâ”€â”€ dispatcher.ts           # å·¥å…·åˆ†å‘å™¨
â”‚   â”œâ”€â”€ editText.ts             # æ–‡æœ¬ç¼–è¾‘æ“ä½œ
â”‚   â”œâ”€â”€ readFile.ts             # æ–‡ä»¶è¯»å–æ“ä½œ
â”‚   â”œâ”€â”€ todoWrite.ts            # Todo åˆ—è¡¨ç®¡ç†å·¥å…·
â”‚   â”œâ”€â”€ tools.ts                # å·¥å…·å®šä¹‰
â”‚   â””â”€â”€ writeFile.ts            # æ–‡ä»¶å†™å…¥æ“ä½œ
â”œâ”€â”€ types/                     # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ index.ts                # å…±äº« TypeScript æ¥å£
â”‚   â””â”€â”€ storage.ts              # å­˜å‚¨ç›¸å…³ç±»å‹å®šä¹‰
â”œâ”€â”€ utils/                     # å®ç”¨å‡½æ•°
â”‚   â”œâ”€â”€ context-compression.ts  # ä¸Šä¸‹æ–‡å‹ç¼©æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ file-helpers.ts         # æ–‡ä»¶å®ç”¨å‡½æ•°
â”‚   â”œâ”€â”€ logger.ts               # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ storage/                # å­˜å‚¨ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ history.ts          # å¯¹è¯å†å²å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ index.ts            # å­˜å‚¨ç®¡ç†å…¥å£
â”‚   â”‚   â””â”€â”€ log.ts              # æ—¥å¿—å­˜å‚¨
â”‚   â”œâ”€â”€ text-helpers.ts         # æ–‡æœ¬å¤„ç†å®ç”¨å‡½æ•°
â”‚   â”œâ”€â”€ tokens.ts               # Token è®¡æ•°å·¥å…·
â”‚   â””â”€â”€ ui.ts                   # UI å·¥å…·ï¼ˆå«çŠ¶æ€æ ï¼‰
â””â”€â”€ index.ts                   # ä¸»ç¨‹åºå…¥å£
```

## å¼€å‘

### ç‰ˆæœ¬ç®¡ç†

æœ¬é¡¹ç›®ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€‚

å¿«é€Ÿå‚è€ƒï¼š

```bash
# ä»…æ›´æ–°ç‰ˆæœ¬å·
npm run version:patch  # 0.5.0 -> 0.5.1
npm run version:minor  # 0.5.1 -> 0.6.0
npm run version:major  # 0.5.1 -> 1.0.0
```

æ‰€æœ‰ç‰ˆæœ¬å·ä¼šè‡ªåŠ¨ä» `package.json` åŒæ­¥ã€‚

### æ·»åŠ æ–°å·¥å…·

è¦å‘åŠ©æ‰‹æ·»åŠ æ–°å·¥å…·ï¼š

1. åœ¨ `src/tools/` ç›®å½•ä¸­åˆ›å»ºæ–°æ–‡ä»¶
2. å®ç°å·¥å…·åŠŸèƒ½
3. å°†å·¥å…·å®šä¹‰æ·»åŠ åˆ° `src/tools/tools.ts`
4. æ›´æ–° `src/tools/dispatcher.ts` ä¸­çš„åˆ†å‘å™¨ä»¥å¤„ç†æ–°å·¥å…·

### ä»£ç ç»„ç»‡

ä»£ç åº“éµå¾ªæ¨¡å—åŒ–æ¶æ„ï¼š

- **config**ï¼šé…ç½®å’Œç¯å¢ƒå˜é‡
- **core**ï¼šæ ¸å¿ƒåŠ©æ‰‹é€»è¾‘å’Œä¸»æ‰§è¡Œå¾ªç¯
- **tools**ï¼šå•ä¸ªå·¥å…·å®ç°å’Œå·¥å…·ç®¡ç†
- **types**ï¼šTypeScript ç±»å‹å®šä¹‰
- **utils**ï¼šå¸¸è§æ“ä½œçš„å®ç”¨å‡½æ•°
- **scripts**ï¼šæ„å»ºå’Œå‘å¸ƒè‡ªåŠ¨åŒ–è„šæœ¬

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éšæ—¶æäº¤ Pull Requestã€‚

1. Fork ä»“åº“
2. åˆ›å»ºæ‚¨çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## è®¸å¯è¯

è¯¥é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - è¯¦æƒ…è¯·è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## è‡´è°¢

- è¯¥é¡¹ç›®å—åˆ° [shareAI-lab/mini_claude_code](https://github.com/shareAI-lab/mini_claude_code) å’Œ [shareAI-lab/Kode](https://github.com/shareAI-lab/Kode) çš„å¯å‘